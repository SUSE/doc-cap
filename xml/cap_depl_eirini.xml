<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter
[
  <!ENTITY % entities SYSTEM "entity-decl.ent">
    %entities;
]>
<chapter version="5.0" xml:id="cha-cap-depl-eirini"
  xmlns="http://docbook.org/ns/docbook"
  xmlns:xi="http://www.w3.org/2001/XInclude"
  xmlns:xlink="http://www.w3.org/1999/xlink">
 <info>
  <title>Eirini</title>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker></dm:bugtracker>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>

 <para>
  Eirini, an alternative to Diego, is a scheduler for the &cf; Application
  Runtime (CFAR) that runs &cf; user applications in &kube;. For details about
  Eirini, see <link xlink:href="https://www.cloudfoundry.org/project-eirini/"/>
  and <link xlink:href="http://eirini.cf"/>
 </para>

 <para>
  Different schedulers and stacks have different memory requirements for
  applications. Not every combination is tested so there is no universal memory
  setting for &cap;, and because it depends on the application deployed, it is
  up to the user to adjust the setting based on their application.
 </para>

 <warning>
  <title>Technology Preview</title>
  <para>
   Eirini is currently included in &productname; as a technology preview to
   allow users to evaluate. It is <emphasis>not</emphasis> supported for use in
   production deployments.
  </para>
  <para>
   As a technology preview, Eirini contains certain limitations to its
   functionality.
  </para>
 </warning>

 <sect1 xml:id="sec-cap-eirini-enable">
  <title>Enabling Eirini</title>

  <procedure>
   <step>
    <para>
     To enable Eirini, and disable Diego, add the following to your
     &values-filename; file.
    </para>
<screen>
features:
  eirini:
    enabled: true
</screen>
    <para>
     When Eirini is enabled, both <literal>features.suse_default_stack</literal>
     and <literal>features.suse_buildpacks</literal> must be enabled as well.
     A cflinuxfs3 Eirini image is currently not available, and the &suse; stack
     must be used. By default, both the &suse; stack and buildpacks are enabled. 
    </para>
    <note>
     <itemizedlist>
      <listitem>
       <para>
        After enabling Eirini, you will still see the
        <literal>diego-api</literal> pod. This is normal behavior because the Diego pod has a component required by Eirini.
       </para>
      </listitem>
      <listitem>
       <para>
        Eirini will only work on a cluster that has the parameter <literal>--cluster-domain</literal> set to <literal>cluster.local</literal>.
       </para>
      </listitem>
     </itemizedlist>
    </note>
   </step>
   <step>
    <para>
     Deploy <literal>kubecf</literal>.
    </para>
    <para>
     Refer to the following for platform-specific instructions:
    </para>
    &deployment-platforms;
   </step>
   <step>
    <para>
     Depending on your cluster configuration, Metrics Server may need to be
     deployed. Use &helm; to install the latest stable Metrics Server.
    </para>
    <para>
     Note that <literal>--kubelet-insecure-tls</literal> is not recommended for
     production usage, but can be useful in test clusters with self-signed
     Kubelet serving certificates. For production, use
     <literal>--tls-private-key-file</literal>.
    </para>
<screen>&prompt.user;helm install <replaceable>metrics-server</replaceable> stable/metrics-server --set args[0]="--kubelet-preferred-address-types=InternalIP" --set args[1]="--kubelet-insecure-tls"</screen>
   </step>
  </procedure>
 </sect1>
</chapter>
